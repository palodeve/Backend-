<h1>Productos en Tiempo Real</h1>

<ul id="productList">
  {{#each products}}
    <li><strong>{{title}}</strong> — ${{price}}</li>
  {{/each}}
</ul>

<h2>Agregar producto</h2>
<form id="formProducto">
  <input type="text" name="title" placeholder="Título" required />
  <input type="text" name="description" placeholder="Descripción" required />
  <input type="text" name="code" placeholder="Código" required />
  <input type="number" name="price" placeholder="Precio" required />
  <input type="number" name="stock" placeholder="Stock" required />
  <input type="text" name="category" placeholder="Categoría" required />
  <button type="submit">Agregar</button>
</form>

<h2>Eliminar producto</h2>
<form id="formEliminar">
  <input type="number" name="id" placeholder="ID del producto" required />
  <button type="submit">Eliminar</button>
</form>

<script src="/socket.io/socket.io.js"></script>
<script>
  const socket = io();

  const form = document.getElementById('formProducto');
  form.addEventListener('submit', (e) => {
    e.preventDefault();
    const data = Object.fromEntries(new FormData(form));
    data.price = Number(data.price);
    data.stock = Number(data.stock);
    socket.emit('nuevoProducto', data);
    form.reset();
  });

  const formEliminar = document.getElementById('formEliminar');
  formEliminar.addEventListener('submit', (e) => {
    e.preventDefault();
    const id = e.target.id.value;
    socket.emit('eliminarProducto', Number(id));
    formEliminar.reset();
  });

  socket.on('actualizarProductos', (products) => {
    const list = document.getElementById('productList');
    list.innerHTML = '';
    products.forEach(p => {
      const li = document.createElement('li');
      li.innerHTML = `<strong>${p.title}</strong> — $${p.price}`;
      list.appendChild(li);
    });
  });
</script>






